# Компонентная архитектура
## Компонентная диаграмма
```plantuml
@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

AddElementTag("microService", $shape=EightSidedShape(), $bgColor="CornflowerBlue", $fontColor="white", $legendText="microservice")
AddElementTag("storage", $shape=RoundedBoxShape(), $bgColor="lightSkyBlue", $fontColor="white")

Person(user, "Пользователь")
Person(gc_owner, "Владелец группового чата")
Person(admin, "Администратор мессенджера")

System_Boundary(messenger_site, "Мессенджер") {
    Container(messenger_front, "Лицевая сторона сайта", "C++/HTML", "Отображаемое пользователю лицо сайта, взаимодествует с микросервисами", $tags = "microService")
    Container(auth_service, "Сервис авторизации", "C++", "Сервис управления пользователями", $tags = "microService")
    Container(group_chat_service, "Сервис групповых чатов", "C++", "Контролирует групповые чаты", $tags = "microService")
    Container(user_chat_service, "Сервис p2p чатов", "C++", "Контролирует межпользательские чаты", $tags = "microService")

    ContainerDb(db, "База данных", "MySQL", "Хранит данные о пользователях и чатах", $tags = "storage")
}

Rel(user, messenger_front, "Взаимодействует с сайтом: регистрируется, пишет сообщения")
Rel(gc_owener, messenger_front, "Создает групповой чат, добавляет в него новых пользователей")

Rel(group_chat_service, auth_service, "Аутентификация", "API")
Rel(user_chat_service, auth_service, "Аутентификация", "API")

Rel(messenger_front, auth_service, "Проверяет введенные пользователем данные, ищет по логину или маске имени и фамилии", "API")
Rel(messenger_front, group_chat_service, "Получает список чатов, их пользователей и содержимое", "API")
Rel(messenger_front, user_chat_service, "Получает список собеседников и связанных чатов", "API")

Rel(auth_service,       db, "Проверяет введенные пользователем данные, ищет по логину или маске имени и фамилии", "API")
Rel(group_chat_service, db, "Получает сообщения", "API")
Rel(user_chat_service,  db, "Получает сообщения", "API")

@enduml
```

## Список компонентов

### Сервис авторизации
**API**:
* Создание нового пользователя
    * входные параметры: login, пароль, имя, фамилия, email, пол
    * выходные параметры: отсутствуют
* Авторизация
    * входные параметры: login, пароль
    * выходные параметры: token аутентификации
* Поиск пользователя по логину
    * входные параметры:  login
    * выходные параметры: имя, фамилия, email, пол
* Поиск пользователя по маске имени и фамилии
    * входные параметры: маска фамилии, маска имени
    * выходные параметры: login, имя, фамилия, email, пол

### Сервис групповых чатов
**API**:
* Создание нового группового чата
    * входные параметры: Название, список пользователей (для начального добавления)
    * выходные параметры: id чата 
* Получение списка групповых чатов
    * входные параметры: -
    * выходные параметры: id чатов
* Добавление нового пользователя в чат
    * входные параметры:  id чата, id пользователя
    * выходные параметры: статус добавления
* Получение пользователей группового чата
    * входные параметры:  id чата
    * выходные параметры: id пользователей
* Добавление нового сообщения в чат
    * входные параметры:  id чата, token аутентификации, сообщение
    * выходные параметры: статус добавления
* Получение сообщений группового чата
    * входные параметры:  id чата
    * выходные параметры: Список из пар - id пользователя и сообщение

### Сервис p2p чатов
**API**:
* Добавление нового сообщения в чат
    * входные параметры:  id пользователя (собеседник), token аутентификации, сообщение
    * выходные параметры: статус добавления
* Получение сообщений пользователя
    * входные параметры:  token аутентификации
    * выходные параметры: Список из пар - id пользователя (собеседник) и сообщение
